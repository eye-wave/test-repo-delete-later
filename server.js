"use strict";var q=Object.create;var d=Object.defineProperty;var x=Object.getOwnPropertyDescriptor;var C=Object.getOwnPropertyNames;var B=Object.getPrototypeOf,P=Object.prototype.hasOwnProperty;var R=(e,t)=>{for(var r in t)d(e,r,{get:t[r],enumerable:!0})},F=(e,t,r,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of C(t))!P.call(e,o)&&o!==r&&d(e,o,{get:()=>t[o],enumerable:!(n=x(t,o))||n.enumerable});return e};var u=(e,t,r)=>(r=e!=null?q(B(e)):{},F(t||!e||!e.__esModule?d(r,"default",{value:e,enumerable:!0}):r,e)),J=e=>F(d({},"__esModule",{value:!0}),e);var W={};R(W,{sendWebsocketMessage:()=>w});module.exports=J(W);var f=u(require("crypto"),1),g=u(require("fs"),1);var S=u(require("net"),1);var y=u(require("path"),1);var m=u(require("zlib"),1);var k="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";function h(e){let t=JSON.parse(m.default.gunzipSync(Buffer.from(e,"base64")).toString()),{entries:r,blob:n}=t,o=[],s=0;for(let c=0;c<r.length;c++){let p=r[c],i=p.index,a=n.substring(s,i);o.push({content:a,mimetype:p.mimetype,route:p.route}),s=i}return o}var b=3e3,U="/home/eyewavu/Pictures",I=h(k);function O(e){let t=g.default.readdirSync(e),r={name:y.default.basename(e),isDir:!0},n=[];for(let o of t){let s=y.default.join(e,o);if(g.default.statSync(s).isDirectory()){let p=O(s);n.push(p);continue}n.push({name:o})}return n.length>0&&(r.nodes=n),r}var D=(e,t,r)=>{let n=O(U),o=JSON.stringify(n);return r.push("Content-Type: application/json"),o};function V(){let e={};return{get(t){return e[t]||null},refresh(t,r=16){return e[t]=f.default.randomBytes(r).toString("base64"),e[t]}}}var T=V();var Q=({search:e},t,r)=>{let[,n]=e.match(/key=([^&]+)/)||[];if(r.push("Content-Type: text/plain"),!n)return T.refresh("SHUTDOWN_KEY");if(n!==T.get("SHUTDOWN_KEY")){t(403);return}process.exit(0)};var j="258EAFA5-E914-47DA-95CA-C5AB0DC85B11",N=[];function K(e){return S.default.createServer(t=>{t.on("data",r=>{var i,a;let n=r.toString();if(n.includes("Upgrade: websocket")){let E=((a=(i=n.match(/Sec-WebSocket-Key: (.+)/))==null?void 0:i[1])==null?void 0:a.trim())||"",l=f.default.createHash("sha1").update(E,"binary").update(j,"binary").digest("base64");N.push(t);let A=["HTTP/1.1 101","Connection: Upgrade","Upgrade: WebSocket",`Sec-WebSocket-Accept: ${l}`,"",""];t.write(A.join(`\r
`));return}let o=n.trim().split(/\r?\n/)||[],[s]=n.match(/\/\S*/)||["/"],[c,p=""]=s.split("?");e(t,{route:c,search:p,headers:o})}),t.on("error",()=>{}),t.on("end",()=>{}),t.on("close",()=>{let r=N.indexOf(t);r!==-1&&N.splice(r,1)}),t.setEncoding("utf8")})}var H=async(e,{route:t,search:r}={route:"/",search:"",headers:[]})=>{let n=["HTTP/1.1 200 OK"],o=t.startsWith("/api"),s=Buffer.from([]),c=null,p=(i=200)=>{n[0]=`HTTP/1.1 ${i}`};try{if(o){let i=t.substring(4),a=[{route:t,search:r},p,n],l={"/shutdown":Q,"/fs/readdir":D}[i];if(l){let A=await l(...a);s=Buffer.from(A||[])}}else for(let i of I)if(i.route===t){n.push(`Content-Type: ${i.mimetype}`),c=i,s=c.content;break}}catch(i){console.error(i),p(500)}!o&&!c&&p(404),n.push("Content-Encoding: gzip"),n.push("",""),e.write(n.join(`\r
`)),e.write(m.default.gzipSync(s)),e.end()},Z=K(H);Z.listen(b,()=>console.log(`Server is running on port ${b}`));function w(e){let t=v(e);N.forEach(r=>r.write(t))}function v(e){let t=Buffer.alloc(2+Buffer.byteLength(e));return t[0]=129,t[1]=Buffer.byteLength(e),Buffer.from(e).copy(t,2),t}0&&(module.exports={sendWebsocketMessage});
